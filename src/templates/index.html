<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>YAYS - Yet Another Youtube Summarizer</title>
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Newsreader:ital,opsz,wght@0,6..72,300;0,6..72,400;0,6..72,600;0,6..72,700;1,6..72,400&family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/iconoir-icons/iconoir@main/css/iconoir.css">
    <link rel="stylesheet" href="/static/css/main.css">
</head>
<body>
    <!-- Header with Tabs -->
    <header>
        <h1><img src="/static/yays_logo.png" alt="YAYS" class="header-logo"> YAYS - Yet Another Youtube Summarizer</h1>
        <nav class="tabs">
            <button class="tab-btn active" onclick="showTab('channels')">Channels</button>
            <button class="tab-btn" onclick="showTab('feed')">Feed</button>
            <button class="tab-btn" onclick="showTab('ai')">AI</button>
            <button class="tab-btn" onclick="showTab('settings')">Settings</button>
            <button class="tab-btn" onclick="showTab('about')">About</button>
            <button class="tab-btn" onclick="showTab('logs')">Logs</button>
        </nav>
    </header>

    <!-- Global Status Bar -->
    <div id="status" class="status"></div>

    <!-- TAB 1: CHANNELS -->
    <div id="tab-channels" class="tab-content active">
        <div class="settings-container">
            <!-- Add Channel Section -->
            <div class="settings-section">
                <h3><i class="iconoir-plus"></i> Add Channel</h3>

                <div class="setting-row">
                    <label class="setting-label">Channel ID or URL</label>
                    <input
                        type="text"
                        id="channelId"
                        class="setting-input"
                        placeholder="UCddiUEpeqJcYeBxX1IVBKvQ"
                        autocomplete="off"
                        autocapitalize="off"
                        autocorrect="off"
                    />
                    <div class="setting-description">
                        Paste YouTube channel URL or ID (name will be auto-fetched)
                    </div>
                </div>

                <div class="setting-row">
                    <label class="setting-label">Display Name (Optional)</label>
                    <input
                        type="text"
                        id="channelName"
                        class="setting-input"
                        placeholder="The Verge"
                        autocomplete="off"
                        maxlength="100"
                    />
                    <div class="setting-description">
                        Leave blank to automatically fetch from YouTube
                    </div>
                </div>

                <button id="addBtn" onclick="addChannel()" style="width: 100%; padding: 16px; font-size: 15px;">
                    Add Channel
                </button>
            </div>

            <!-- Active Channels Section -->
            <div class="settings-section" id="channelsSection">
                <h3><i class="iconoir-youtube"></i> Active Channels (<span id="count">0</span>)</h3>

                <div id="loading" class="loading">Loading channels...</div>

                <div id="empty" class="empty" style="display: none;">
                    <div class="empty-icon">—</div>
                    <p class="empty-text">No channels configured</p>
                </div>

                <div id="channels" class="channels-list"></div>
            </div>
        </div>
    </div>

    <!-- TAB 2: FEED -->
    <div id="tab-feed" class="tab-content">
        <div class="settings-container">
            <!-- Quick Add Video Section -->
            <!-- Allows manual addition of individual YouTube videos by URL -->
            <!-- Videos are marked with source_type='via_manual' in database -->
            <!-- Follows same processing pipeline: transcript -> AI summary -> email -->
            <div class="settings-section">
                <h3><i class="iconoir-flash"></i> Quick Add Video</h3>

                <div class="setting-row">
                    <label class="setting-label">YouTube Video URL</label>
                    <input
                        type="text"
                        id="singleVideoUrl"
                        class="setting-input"
                        placeholder="https://youtube.com/watch?v=..."
                        autocomplete="off"
                        autocapitalize="off"
                        autocorrect="off"
                    />
                    <div class="setting-description">
                        Paste any YouTube video URL to process it immediately
                    </div>
                </div>

                <button id="addSingleVideoBtn" onclick="addSingleVideo()" style="width: 100%; padding: 16px; font-size: 15px;">
                    Process Video
                </button>

                <!-- Status message for single video addition -->
                <div id="singleVideoStatus" class="status"></div>
            </div>

            <!-- Processed Videos Feed Section -->
            <div class="settings-section" id="feedSection">
                <h3><i class="iconoir-video-camera"></i> Processed Videos (<span id="feedCount">0</span>)</h3>

                <!-- Feed Controls -->
                <div class="feed-controls">
                    <div class="feed-filters">
                        <select id="feedChannelFilter" class="setting-input" style="width: 200px;" onchange="filterFeed()">
                            <option value="">All Sources</option>
                        </select>

                        <select id="feedSortOrder" class="setting-input" style="width: 150px;" onchange="filterFeed()">
                            <option value="recent">Most Recent</option>
                            <option value="oldest">Oldest First</option>
                            <option value="channel">By Channel</option>
                        </select>
                    </div>

                    <button class="btn-secondary btn-check-now" onclick="checkNow()">
                        Check for New Videos
                    </button>
                </div>

                <div id="feedEmpty" class="empty" style="display: none;">
                    <div class="empty-icon">—</div>
                    <p class="empty-text">No videos processed yet</p>
                </div>

                <div id="videoFeed" class="video-feed"></div>

                <button id="loadMoreBtn" class="btn-secondary" style="width: 100%; display: none;" onclick="loadMoreVideos()">
                    Load More (<span id="remainingCount">0</span> remaining)
                </button>
            </div>
        </div>
    </div>

    <!-- TAB 3: SETTINGS -->
    <div id="tab-settings" class="tab-content">
        <div class="settings-container">
            <!-- Email Configuration Section -->
            <div class="settings-section">
                <h3><i class="iconoir-mail"></i> Email Configuration <span id="unsaved-email" class="unsaved-indicator" style="display: none;">● Unsaved changes</span></h3>

                <div class="setting-row">
                    <label class="setting-label">Send Email Summaries</label>
                    <select id="SEND_EMAIL_SUMMARIES" class="setting-input trackable-input" data-section="email" onchange="toggleEmailFields()">
                        <option value="true">Enabled (Send via email)</option>
                        <option value="false">Disabled (Save only)</option>
                    </select>
                    <div class="setting-description">When enabled, summaries are sent via email (requires restart)</div>
                </div>

                <div class="setting-row email-field">
                    <label class="setting-label">Target Email</label>
                    <input type="email" id="TARGET_EMAIL" class="setting-input trackable-input" data-section="email">
                    <div class="setting-description">Email-to-tag address for receiving summaries</div>
                </div>

                <div class="setting-row email-field">
                    <label class="setting-label">Gmail SMTP User</label>
                    <input type="email" id="SMTP_USER" class="setting-input trackable-input" data-section="email">
                    <div class="setting-description">Your Gmail address</div>
                </div>

                <div class="setting-row email-field">
                    <label class="setting-label">Gmail App Password</label>
                    <input type="password" id="SMTP_PASS" class="setting-input trackable-input" data-section="email" placeholder="16-character app password">
                    <div class="setting-description">16-character app password - <a href="https://myaccount.google.com/apppasswords" target="_blank" style="color: var(--black); text-decoration: underline;">Create Gmail App Password</a></div>
                    <button class="btn-test" onclick="sendTestEmail()">Send Test Email</button>
                    <div id="smtp-test-result"></div>
                </div>
            </div>

            <!-- Video Processing Settings -->
            <div class="settings-section">
                <h3><i class="iconoir-settings"></i> Video Processing <span id="unsaved-video" class="unsaved-indicator" style="display: none;">● Unsaved changes</span></h3>

                <div class="setting-row">
                    <label class="setting-label">Auto-Check Interval (hours)</label>
                    <input type="number" id="CHECK_INTERVAL_HOURS" class="setting-input trackable-input" data-section="video" min="1" max="24">
                    <div class="setting-description">How often to automatically check for new videos (requires restart)</div>
                </div>

                <div class="setting-row">
                    <div class="checkbox-row">
                        <input type="checkbox" id="SKIP_SHORTS" class="trackable-input" data-section="video">
                        <label for="SKIP_SHORTS" class="setting-label">Skip YouTube Shorts</label>
                    </div>
                    <div class="setting-description">Ignore videos shorter than 60 seconds</div>
                </div>
            </div>

            <!-- Transcript Settings -->
            <div class="settings-section">
                <h3><i class="iconoir-page-edit"></i> Transcript Settings <span id="unsaved-transcript" class="unsaved-indicator" style="display: none;">● Unsaved changes</span></h3>

                <div class="setting-row">
                    <div class="setting-description" style="margin-bottom: 16px; padding: 12px; background: #f8f9fa; border-left: 3px solid #007bff; border-radius: 4px;">
                        <strong>4-Method Cascade:</strong> All videos automatically try these methods in order:
                        <ol style="margin: 8px 0 0 20px; padding: 0;">
                            <li>YouTube Transcript API (free)</li>
                            <li>yt-dlp Subtitles (free)</li>
                            <li>Direct Timedtext API (free)</li>
                            <li>Supadata.ai Fallback (paid, optional)</li>
                        </ol>
                    </div>
                </div>

                <div class="setting-row">
                    <label class="setting-label">
                        <input type="checkbox" id="ENABLE_SUPADATA_FALLBACK" class="trackable-input" data-section="transcript" onchange="toggleSupadataFallback()" style="margin-right: 8px; width: auto; height: auto;">
                        Activate Supadata Fallback (paid after 100 fetches)
                    </label>
                    <div class="setting-description">
                        Enable Supadata.ai as the final fallback method when all free methods fail.
                        <a href="https://supadata.ai" target="_blank" style="color: #007bff;">Get API key</a>
                    </div>
                </div>

                <div class="setting-row" id="supadata-api-row" style="display: none;">
                    <label class="setting-label">Supadata API Key</label>
                    <input type="password" id="SUPADATA_API_KEY" class="setting-input trackable-input" data-section="transcript" placeholder="sd_...">
                    <div class="setting-description">
                        Get your API key from <a href="https://supadata.ai" target="_blank" style="color: #007bff;">supadata.ai</a>
                        (100 free credits/month, Pro: $29/mo for 10K credits)
                    </div>
                </div>
            </div>

            <!-- Status Message -->
            <div id="settingsStatus" class="status"></div>

            <!-- Restart Notification -->
            <div id="restartNotification" class="restart-notification" style="display: none;">
                Settings updated. Restart Docker containers to apply changes.
                <button onclick="restartApplication()" class="btn-restart-inline">Restart Now</button>
            </div>

            <!-- Save Button -->
            <button onclick="saveAllSettings(this)" style="width: 100%; padding: 16px; font-size: 15px;">
                Save Settings
            </button>

            <!-- Backup & Restore Section -->
            <div class="settings-section" style="margin-top: 40px;">
                <h3><i class="iconoir-floppy-disk"></i> Backup & Restore</h3>
                <div class="setting-description" style="margin-bottom: 20px;">
                    Export your data for backup or migration. Import previously exported files to restore your configuration.
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; align-items: start;">
                    <!-- Export Column -->
                    <div style="display: grid; grid-template-rows: auto auto auto; gap: 12px;">
                        <div>
                            <h4 style="margin-bottom: 15px; font-size: 16px;">Export</h4>
                            <div class="setting-description" style="margin-bottom: 15px;">
                                Choose export level and format:
                            </div>
                        </div>

                        <button onclick="exportFeed('json')" class="btn-export" style="width: 100%; text-align: left; padding: 12px 16px;">
                            <div style="font-weight: bold;">Export Feed (JSON)</div>
                            <div style="font-size: 12px; color: #888; margin-top: 4px;">Channels + videos with summaries</div>
                        </button>

                        <button onclick="exportFeed('csv')" class="btn-export" style="width: 100%; text-align: left; padding: 12px 16px;">
                            <div style="font-weight: bold;">Export Videos (CSV)</div>
                            <div style="font-size: 12px; color: #888; margin-top: 4px;">Videos only, for spreadsheet analysis</div>
                        </button>

                        <button onclick="exportBackup()" class="btn-export" style="width: 100%; text-align: left; padding: 12px 16px;">
                            <div style="font-weight: bold;">Export Complete Backup (JSON)</div>
                            <div style="font-size: 12px; color: #888; margin-top: 4px;">Channels + videos + settings + AI prompt (credentials excluded for security)</div>
                        </button>
                    </div>

                    <!-- Import Column -->
                    <div style="display: grid; grid-template-rows: auto 1fr auto; gap: 12px;">
                        <div>
                            <h4 style="margin-bottom: 15px; font-size: 16px;">Import</h4>
                            <div class="setting-description" style="margin-bottom: 15px;">
                                Drag and drop JSON file, or click to browse:
                            </div>
                        </div>

                        <!-- Dropzone - spans 2 export buttons height -->
                        <div id="importDropzone" class="import-dropzone" style="min-height: 150px;">
                            <div id="dropzoneDefault" class="dropzone-content">
                                <i class="iconoir-folder" style="font-size: 24px; margin-bottom: 10px;"></i>
                                <div>Drop JSON file here</div>
                                <div style="font-size: 12px; color: #666; margin-top: 8px;">or click below</div>
                            </div>
                            <div id="dropzoneFile" class="dropzone-content" style="display: none;">
                                <div id="dropzoneFileName" style="font-weight: bold; margin-bottom: 8px;"></div>
                                <div id="dropzoneValidating" style="font-size: 14px; color: #888;">Validating...</div>
                            </div>
                        </div>

                        <!-- Browse Files Button - aligns with Export Complete Backup -->
                        <div>
                            <input type="file" id="importFileInput" accept=".json" style="display: none;" onchange="handleFileSelect(event)">
                            <button onclick="document.getElementById('importFileInput').click()" class="btn-secondary" style="width: 100%;">
                                Browse Files
                            </button>

                            <!-- Validation Preview -->
                            <div id="validationPreview" class="validation-preview" style="display: none; margin-top: 16px;">
                                <div id="validationContent"></div>
                            </div>

                            <!-- Import Buttons - only shown after file is uploaded -->
                            <div id="importButtonsContainer" style="display: none; gap: 8px; margin-top: 12px;">
                                <button id="importButton" onclick="executeImport()" disabled class="btn-import" style="flex: 1;">
                                    Import
                                </button>
                                <button onclick="cancelImport()" class="btn-secondary" style="flex: 1;">
                                    Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Logging Configuration -->
            <div class="settings-section">
                <h3><i class="iconoir-terminal"></i> Logging</h3>

                <div class="setting-row">
                    <label class="setting-label" for="logRetentionDays">
                        Log Retention Period
                        <span class="unsaved-indicator" id="unsaved-logging" style="display: none;">
                            (Unsaved)
                        </span>
                    </label>
                    <input
                        type="number"
                        id="logRetentionDays"
                        class="setting-input"
                        min="1"
                        max="30"
                        value="7"
                        oninput="showUnsavedIndicator('logging')"
                    />
                    <div class="setting-description">
                        Automatically delete logs older than this many days (1-30)
                    </div>
                </div>

                <button onclick="saveLoggingSettings()" class="btn-primary">
                    Save Logging Settings
                </button>
            </div>

            <!-- Danger Zone Section (Separate) -->
            <div class="settings-section" style="margin-top: 40px; border: 2px solid #ff4444;">
                <h3 style="color: #ff4444; cursor: pointer; user-select: none;" onclick="toggleDangerZone()">
                    <span id="dangerZoneToggle">▶</span> <i class="iconoir-warning-triangle"></i> Danger Zone
                </h3>

                <div id="dangerZoneContent" style="display: none;">
                    <div class="setting-row">
                        <button onclick="promptResetSettings()" class="btn-danger" style="width: 100%;">
                            Reset Settings
                        </button>
                        <div class="setting-description" style="color: #888;">
                            Resets all settings and AI prompt to defaults. Channels and feed history will be preserved.
                        </div>
                    </div>

                    <div class="setting-row">
                        <button onclick="promptResetFeedHistory()" class="btn-danger" style="width: 100%;">
                            Reset Feed History
                        </button>
                        <div class="setting-description" style="color: #888;">
                            Deletes all processed videos from the feed. Channels and settings will be preserved.
                        </div>
                    </div>

                    <div class="setting-row">
                        <button onclick="promptResetYoutubeData()" class="btn-danger" style="width: 100%;">
                            Reset YouTube Data
                        </button>
                        <div class="setting-description" style="color: #888;">
                            Deletes all channels and feed history. Settings and prompts will be preserved.
                        </div>
                    </div>

                    <div class="setting-row">
                        <button onclick="promptResetCompleteApp()" class="btn-danger" style="width: 100%;">
                            Reset Complete App
                        </button>
                        <div class="setting-description" style="color: #888;">
                            Deletes all data: channels, feed history, and resets all settings and prompts to defaults.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TAB 4: AI -->
    <div id="tab-ai" class="tab-content">
        <div class="settings-container">
            <!-- AI Settings Section -->
            <div class="settings-section">
                <h3><i class="iconoir-key"></i> AI Settings <span id="unsaved-ai-credentials" class="unsaved-indicator" style="display: none;">● Unsaved changes</span></h3>

                <div class="setting-row">
                    <label class="setting-label">OpenAI API Key</label>
                    <input type="password" id="OPENAI_API_KEY" class="setting-input trackable-input" data-section="ai-credentials" placeholder="sk-...">
                    <div class="setting-description">Get from: https://platform.openai.com/api-keys</div>
                    <button class="btn-test" onclick="testOpenAIKey()">Test OpenAI API</button>
                    <div id="openai-test-result"></div>
                </div>

                <div class="setting-row">
                    <label class="setting-label">OpenAI Model</label>
                    <select id="OPENAI_MODEL" class="setting-input trackable-input" data-section="ai-credentials">
                        <option value="">Loading models...</option>
                    </select>
                    <div class="setting-description">Model used for generating summaries</div>
                </div>

                <div class="setting-row">
                    <div class="checkbox-row">
                        <input type="checkbox" id="USE_SUMMARY_LENGTH" class="trackable-input" data-section="ai-credentials" onchange="toggleSummaryLengthInput()">
                        <label for="USE_SUMMARY_LENGTH" class="setting-label">Limit Summary Length</label>
                    </div>
                    <div class="setting-description">Enable to set a maximum token limit for summaries</div>
                </div>

                <div class="setting-row" id="summaryLengthRow">
                    <label class="setting-label">Summary Length (tokens)</label>
                    <input type="number" id="SUMMARY_LENGTH" class="setting-input trackable-input" data-section="ai-credentials" min="100" max="2000">
                    <div class="setting-description">Maximum summary length (affects cost)</div>
                </div>
            </div>

            <!-- AI Prompt Template Section -->
            <div class="settings-section">
                <h3><i class="iconoir-edit-pencil"></i> AI Prompt Template <span id="unsaved-prompt" class="unsaved-indicator" style="display: none;">● Unsaved changes</span></h3>

                <div class="setting-row">
                    <label class="setting-label">Prompt</label>
                    <textarea id="promptEditor" class="prompt-editor trackable-input" data-section="prompt"></textarea>
                    <div class="setting-description">
                        Available variables: {title}, {duration}, {transcript}
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn-secondary" onclick="resetPrompt()">Reset to Default</button>
                    <button onclick="savePrompt(this)">Save Prompt</button>
                </div>

                <!-- Status for Prompt -->
                <div id="aiStatus" class="status"></div>
            </div>

            <!-- Status for AI Credentials -->
            <div id="aiSettingsStatus" class="status"></div>

            <!-- Save AI Credentials Button -->
            <button onclick="saveAICredentials(this)" style="width: 100%; padding: 16px; font-size: 15px; margin-top: var(--space-2);">
                Save AI Settings
            </button>
        </div>
    </div>

    <!-- TAB 5: ABOUT -->
    <div id="tab-about" class="tab-content">
        <div class="settings-container">
            <div class="settings-section" style="text-align: center; padding: 40px 20px;">
                <!-- Logo -->
                <div style="margin-bottom: 30px;">
                    <img src="/static/yays_logo.png" alt="YAYS Logo" class="about-logo">
                </div>

                <!-- App Name and Version -->
                <h2 style="font-size: 24px; margin-bottom: 10px; font-weight: 600;">
                    YAYS - Yet Another Youtube Summarizer
                </h2>
                <div style="font-size: 16px; color: #999; margin-bottom: 30px;">
                    Version 0.1
                </div>

                <!-- Description -->
                <div style="max-width: 600px; margin: 0 auto 40px; line-height: 1.6; color: #666;">
                    <p style="margin-bottom: 16px;">
                        YAYS automatically monitors your favorite YouTube channels, downloads transcripts,
                        generates AI-powered summaries, and delivers them directly to your inbox.
                    </p>
                    <p>
                        Built with modern web technologies and powered by OpenAI's GPT models.
                    </p>
                </div>

                <!-- GitHub Link -->
                <div style="margin-top: 40px;">
                    <a href="https://github.com/icon3333/YAYS---Yet-Another-Youtube-Summarizer"
                       target="_blank"
                       rel="noopener noreferrer"
                       style="display: inline-flex; align-items: center; gap: 12px; padding: 12px 24px; background: var(--black); color: var(--white); text-decoration: none; border-radius: 6px; font-weight: 500; transition: opacity 0.2s;">
                        <svg height="24" width="24" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                        </svg>
                        View on GitHub
                    </a>
                </div>

                <!-- Footer -->
                <div style="margin-top: 60px; padding-top: 30px; border-top: 1px solid #e0e0e0; font-size: 13px; color: #999;">
                    <p>Made with care for YouTube enthusiasts</p>
                </div>
            </div>
        </div>
    </div>

    <!-- TAB 6: LOGS -->
    <div id="tab-logs" class="tab-content">
        <div class="settings-container">
            <h2>Application Logs</h2>

            <!-- Log Source Toggle -->
            <div class="log-toggle-container">
                <button class="log-toggle-btn active" data-log="summarizer" onclick="toggleLogSource('summarizer')">
                    Summarizer Container
                </button>
                <button class="log-toggle-btn" data-log="web" onclick="toggleLogSource('web')">
                    Web Container
                </button>
            </div>

            <!-- Filter and Search -->
            <div class="log-controls">
                <div class="log-control-group">
                    <label for="logLevelFilter">Filter:</label>
                    <select id="logLevelFilter" onchange="applyLogFilters()">
                        <option value="all">All Levels</option>
                        <option value="ERROR">ERROR</option>
                        <option value="WARNING">WARNING</option>
                        <option value="INFO">INFO</option>
                        <option value="DEBUG">DEBUG</option>
                    </select>
                </div>

                <div class="log-control-group">
                    <label for="logSearch">Search:</label>
                    <input
                        type="text"
                        id="logSearch"
                        placeholder="Search logs..."
                        oninput="applyLogFilters()"
                    />
                    <button class="btn-icon" onclick="clearLogSearch()" title="Clear search">✕</button>
                </div>
            </div>

            <!-- Log Info -->
            <div id="logInfo" class="log-info">
                Loading logs...
            </div>

            <!-- Log Viewer -->
            <div id="logViewer" class="log-viewer">
                <div class="log-loading">Loading logs...</div>
            </div>

            <!-- Action Buttons -->
            <div class="log-actions">
                <button onclick="copyAllLogs()" class="btn-secondary">Copy All Logs</button>
                <button onclick="downloadLogs()" class="btn-secondary">Download Logs</button>
                <button onclick="manualRefreshLogs()" class="btn-secondary">Manual Refresh</button>
                <button id="autoRefreshBtn" onclick="toggleAutoRefresh()" class="btn-secondary">
                    Auto-refresh: OFF
                </button>
            </div>
        </div>
    </div>

    <!-- Modal for confirmations -->
    <!-- Confirmation Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <h3 class="modal-title" id="modalTitle">Remove Channel</h3>
            <p class="modal-message" id="modalMessage"></p>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-cancel" onclick="closeModal()">Cancel</button>
                <button class="modal-btn modal-btn-confirm" id="modalConfirmBtn" onclick="confirmRemove()">Remove</button>
            </div>
        </div>
    </div>

    <!-- Summary Modal -->
    <div id="summaryModal" class="modal">
        <div class="modal-content modal-summary">
            <div class="modal-header-summary">
                <h2 id="summaryTitle" class="summary-modal-title"></h2>
                <button class="modal-close" onclick="closeSummaryModal()">&times;</button>
            </div>
            <div class="modal-body-summary">
                <div class="summary-meta">
                    <div class="meta-item">
                        <span class="meta-label">Channel:</span>
                        <span id="summaryChannel" class="meta-value"></span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Duration:</span>
                        <span id="summaryDuration" class="meta-value"></span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Views:</span>
                        <span id="summaryViews" class="meta-value"></span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Uploaded:</span>
                        <span id="summaryUploadDate" class="meta-value"></span>
                    </div>
                </div>
                <div class="summary-text" id="summaryText"></div>
            </div>
            <div class="modal-footer-summary">
                <a id="summaryYoutubeLink" href="" target="_blank" class="btn-primary btn-youtube">
                    Watch on YouTube →
                </a>
            </div>
        </div>
    </div>

    <!-- Logs Modal -->
    <div id="logsModal" class="modal">
        <div class="modal-content modal-logs">
            <div class="modal-header-summary">
                <h2 id="logsTitle" class="summary-modal-title"></h2>
                <button class="modal-close" onclick="closeLogsModal()">&times;</button>
            </div>
            <div class="modal-body-summary">
                <div id="logsStatus" class="meta-label" style="margin-bottom: 8px;"></div>
                <pre id="logsBody" class="logs-pre"></pre>
            </div>
        </div>
    </div>

    <!-- Table of Contents (Desktop) -->
    <div class="toc-container" id="tocContainer">
        <nav class="toc-nav">
            <div class="toc-header">Contents</div>
            <ul class="toc-list" id="tocList">
                <!-- Dynamically populated -->
            </ul>
        </nav>
    </div>

    <!-- Table of Contents Toggle (Mobile) -->
    <button class="toc-toggle" id="tocToggle" aria-label="Open table of contents">
        <span class="toc-hamburger-line"></span>
        <span class="toc-hamburger-line"></span>
        <span class="toc-hamburger-line"></span>
    </button>

    <!-- Table of Contents Drawer (Mobile) -->
    <div class="toc-drawer" id="tocDrawer">
        <div class="toc-drawer-header">
            <span>Contents</span>
            <button class="toc-drawer-close" id="tocDrawerClose" aria-label="Close">&times;</button>
        </div>
        <nav class="toc-nav">
            <ul class="toc-list" id="tocListMobile">
                <!-- Dynamically populated -->
            </ul>
        </nav>
    </div>

    <!-- TOC Backdrop (Mobile) -->
    <div class="toc-backdrop" id="tocBackdrop"></div>

    <script src="/static/js/app.js"></script>
</body>
</html>
